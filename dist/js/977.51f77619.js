"use strict";(self["webpackChunkproject"]=self["webpackChunkproject"]||[]).push([[977],{9789:function(e,t,o){o.d(t,{Z:function(){return b}});var a=o(3396),n=o(7139);const s={class:"modal",tabindex:"-1",ref:"modal"},l={class:"modal-dialog"},i={class:"modal-content"},p=(0,a._)("div",{class:"modal-header bg-danger"},[(0,a._)("h5",{class:"modal-title"},"刪除訂單"),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),d={class:"modal-body"},u={class:"modal-footer"},c=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function r(e,t,o,r,h,m){return(0,a.wg)(),(0,a.iD)("div",s,[(0,a._)("div",l,[(0,a._)("div",i,[p,(0,a._)("div",d,[(0,a._)("p",null,"是否確定要刪除訂單編號"+(0,n.zw)(o.item.id)+"?",1)]),(0,a._)("div",u,[c,(0,a._)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=t=>e.$emit("del-item"))},"確定")])])])],512)}var h=o(1339),m={props:{item:{}},data(){return{modal:""}},mixins:[h.Z]},g=o(89);const _=(0,g.Z)(m,[["render",r]]);var b=_},4869:function(e,t,o){o.d(t,{Z:function(){return v}});var a=o(3396),n=o(9242),s=o(7139);const l={"aria-label":"Page navigation example"},i={class:"pagination justify-content-center"},p={key:0,class:"page-item"},d=(0,a._)("span",{"aria-hidden":"true"},"«",-1),u=[d],c=["onClick"],r={key:1,class:"page-item"},h=(0,a._)("span",{"aria-hidden":"true"},"»",-1),m=[h];function g(e,t,o,d,h,g){return(0,a.wg)(),(0,a.iD)("nav",l,[(0,a._)("ul",i,[o.pages.has_pre?((0,a.wg)(),(0,a.iD)("li",p,[(0,a._)("a",{class:"page",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,n.iM)((e=>g.previousPage(o.pages)),["prevent"]))},u)])):(0,a.kq)("",!0),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.pages.total_pages,(e=>((0,a.wg)(),(0,a.iD)("li",{class:"page-item",key:e},[(0,a._)("a",{class:(0,s.C_)(["page",{active:e===o.pages.current_page}]),href:"#",onClick:(0,n.iM)((t=>g.updatePage(e)),["prevent"])},(0,s.zw)(e),11,c)])))),128)),o.pages.has_next?((0,a.wg)(),(0,a.iD)("li",r,[(0,a._)("a",{class:"page",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,n.iM)((e=>g.nextPage(o.pages)),["prevent"]))},m)])):(0,a.kq)("",!0)])])}var _={props:["pages"],data(){return{nowPage:""}},methods:{updatePage(e){this.$emit("emit-pages",e),this.nowPage=e,this.scrollToPosition()},previousPage(e){this.nowPage=e.current_page,this.nowPage>1?this.nowPage--:this.nowPage=1,this.updatePage(this.nowPage),this.scrollToPosition()},nextPage(e){this.nowPage=e.current_page,this.nowPage<e.total_pages?this.nowPage++:this.nowPage=e.total_pages,this.updatePage(this.nowPage),this.scrollToPosition()},scrollToPosition(){"user-shopping"===this.$route.name&&window.scrollTo({top:310,behavior:"smooth"})}}},b=o(89);const C=(0,b.Z)(_,[["render",g]]);var v=C},1977:function(e,t,o){o.r(t),o.d(t,{default:function(){return E}});var a=o(3396),n=o(7139);const s={class:"text-end mt-4"},l={class:"table mt-4 admin"},i=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"名稱"),(0,a._)("th",null,"折扣百分比"),(0,a._)("th",null,"到期日"),(0,a._)("th",null,"是否啟用"),(0,a._)("th",null,"編輯")])],-1),p={key:0,class:"text-success"},d={key:1,class:"text-muted"},u={class:"btn-group"},c=["onClick"],r=["onClick"];function h(e,t,o,h,m,g){const _=(0,a.up)("LoadingComponent"),b=(0,a.up)("Pagination"),C=(0,a.up)("couponModal"),v=(0,a.up)("DelModal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(_,{active:m.isLoading},null,8,["active"]),(0,a._)("div",null,[(0,a._)("div",s,[(0,a._)("button",{class:"btn btn-dark",onClick:t[0]||(t[0]=e=>g.openCouponModal(!0))}," 建立新的優惠券 ")]),(0,a._)("table",l,[i,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(m.coupons,((t,o)=>((0,a.wg)(),(0,a.iD)("tr",{key:o},[(0,a._)("td",null,(0,n.zw)(t.title),1),(0,a._)("td",null,(0,n.zw)(t.percent)+"%",1),(0,a._)("td",null,(0,n.zw)(e.$filters.date(t.due_date)),1),(0,a._)("td",null,[1===t.is_enabled?((0,a.wg)(),(0,a.iD)("span",p,"啟用")):((0,a.wg)(),(0,a.iD)("span",d,"未啟用"))]),(0,a._)("td",null,[(0,a._)("div",u,[(0,a._)("button",{class:"btn btn-outline-dark btn-sm",onClick:e=>g.openCouponModal(!1,t)},"編輯",8,c),(0,a._)("button",{class:"btn btn-outline-danger btn-sm",onClick:e=>g.openDelCouponModal(t)},"刪除",8,r)])])])))),128))])]),(0,a.Wm)(b,{pages:m.pagination,onEmitPages:g.getCoupons},null,8,["pages","onEmitPages"]),(0,a.Wm)(C,{coupon:m.tempCoupon,ref:"couponModal",onUpdateCoupon:g.updateCoupon},null,8,["coupon","onUpdateCoupon"]),(0,a.Wm)(v,{item:m.tempCoupon,ref:"delModal",onDelItem:g.delCoupon},null,8,["item","onDelItem"])])],64)}var m=o(9789),g=o(9242);const _={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},b={class:"modal-dialog",role:"document"},C={class:"modal-content"},v=(0,a._)("div",{class:"modal-header"},[(0,a._)("h5",{class:"modal-title",id:"exampleModalLabel"},"新增優惠券"),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),w={class:"modal-body"},f={class:"mb-3"},M=(0,a._)("label",{for:"title"},"標題",-1),P={class:"mb-3"},k=(0,a._)("label",{for:"coupon_code"},"優惠碼",-1),y={class:"mb-3"},x=(0,a._)("label",{for:"due_date"},"到期日",-1),D={class:"mb-3"},$=(0,a._)("label",{for:"price"},"折扣百分比",-1),Z={class:"mb-3"},L={class:"form-check"},T=(0,a._)("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),U={class:"modal-footer"},j=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);function z(e,t,o,n,s,l){return(0,a.wg)(),(0,a.iD)("div",_,[(0,a._)("div",b,[(0,a._)("div",C,[v,(0,a._)("div",w,[(0,a._)("div",f,[M,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>s.tempCoupon.title=e),placeholder:"請輸入標題"},null,512),[[g.nr,s.tempCoupon.title]])]),(0,a._)("div",P,[k,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":t[1]||(t[1]=e=>s.tempCoupon.code=e),placeholder:"請輸入優惠碼"},null,512),[[g.nr,s.tempCoupon.code]])]),(0,a._)("div",y,[x,(0,a.wy)((0,a._)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[2]||(t[2]=e=>s.due_date=e)},null,512),[[g.nr,s.due_date]])]),(0,a._)("div",D,[$,(0,a.wy)((0,a._)("input",{type:"number",class:"form-control",id:"price","onUpdate:modelValue":t[3]||(t[3]=e=>s.tempCoupon.percent=e),placeholder:"請輸入折扣百分比"},null,512),[[g.nr,s.tempCoupon.percent,void 0,{number:!0}]])]),(0,a._)("div",Z,[(0,a._)("div",L,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=e=>s.tempCoupon.is_enabled=e),id:"is_enabled"},null,512),[[g.e8,s.tempCoupon.is_enabled]]),T])])]),(0,a._)("div",U,[j,(0,a._)("button",{type:"button",class:"btn btn-dark",onClick:t[5]||(t[5]=t=>e.$emit("update-coupon",s.tempCoupon))},"更新優惠券 ")])])])],512)}var N=o(1339),V={name:"couponModal",props:{coupon:{}},data(){return{tempCoupon:{},due_date:""}},emits:["update-coupon"],watch:{coupon(){this.tempCoupon=this.coupon,console.log(this.tempCoupon.due_date);const e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T");[this.due_date]=e},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}},mixins:[N.Z]},S=o(89);const W=(0,S.Z)(V,[["render",z]]);var H=W,I=o(4869),Y={props:{config:Object},components:{DelModal:m.Z,couponModal:H,Pagination:I.Z},inject:["emitter"],data(){return{coupons:{},tempCoupon:{title:"",is_enabled:0,percent:100,code:""},pagination:{},isLoading:!1,isNew:!1}},methods:{openCouponModal(e,t){this.isNew=e,this.isNew?this.tempCoupon={due_date:(new Date).getTime()/1e3}:this.tempCoupon={...t},this.$refs.couponModal.showModal()},openDelCouponModal(e){this.tempCoupon={...e},this.$refs.delModal.showModal()},getCoupons(e=1){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/cc45001127-api/admin/coupons?page=${e}`;this.$http.get(t,this.tempProduct).then((e=>{this.coupons=e.data.coupons,this.isLoading=!1,this.pagination=e.data.pagination}))},updateCoupon(e){if(this.isNew){const t="https://vue3-course-api.hexschool.io/api/cc45001127-api/admin/coupon";this.$http.post(t,{data:e}).then((e=>{this.$httpMessageState(e,"新增優惠券"),this.getCoupons(),this.$refs.couponModal.hideModal()}))}else{const e=`https://vue3-course-api.hexschool.io/api/cc45001127-api/admin/coupon/${this.tempCoupon.id}`;this.$http.put(e,{data:this.tempCoupon}).then((e=>{console.log(e),this.$httpMessageState(e,"更新優惠券"),this.getCoupons(),this.$refs.couponModal.hideModal()}))}},delCoupon(){const e=`https://vue3-course-api.hexschool.io/api/cc45001127-api/admin/coupon/${this.tempCoupon.id}`;this.isLoading=!0,this.$http.delete(e).then((e=>{this.emitter.emit("push-message",{style:"warning",title:"已刪除優惠券"});const t=this.$refs.delModal;t.hideModal(),this.getCoupons()}))}},created(){this.getCoupons()}};const q=(0,S.Z)(Y,[["render",h]]);var E=q}}]);
//# sourceMappingURL=977.51f77619.js.map